<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ˜è³¼åŠ©æ‰‹</title>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        body { font-family: sans-serif; padding: 15px; background: #f4f7f6; }
        .card { background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 20px; }
        textarea { width: 100%; box-sizing: border-box; border: 1px solid #ddd; border-radius: 5px; padding: 10px; font-size: 14px; }
        button { width: 100%; padding: 12px; border: none; border-radius: 5px; color: white; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .btn-update { background-color: #00b900; }
        .btn-notice { background-color: #007bff; }
    </style>
</head>
<body>

<div class="card">
    <h3>ğŸ“¦ è¨‚è³¼</h3>
    <textarea id="orderData" rows="8" placeholder="è²¼ä¸ŠåŒ…å« #åº—å®¶ çš„è¨‚è³¼å…§å®¹..."></textarea>
    <button class="btn-update" onclick="sendOrder()">ç¢ºèªä¸¦æ›´æ–°å¾Œå°</button>
</div>

<div class="card">
    <h3>ğŸ”” ç”¢ç”Ÿåˆ°è²¨é€šçŸ¥</h3>
    <input type="text" id="storeName" placeholder="è¼¸å…¥åº—å®¶åç¨±" style="width:100%; padding:8px; box-sizing:border-box;">
    <button class="btn-notice" onclick="sendNoticeRequest()">ç”¢ç”Ÿæ¨™ç±¤é€šçŸ¥æ–‡å­—</button>
</div>

<script>
    // åˆå§‹åŒ– LIFF
    liff.init({ liffId: "ä½ çš„LIFF_ID" }).then(() => {
        if (!liff.isLoggedIn()) liff.login();
    });

    // æ¨¡å¼ 1 & 2ï¼šé€å‡ºè¨‚å–®æ–‡å­—çµ¦ GAS
    async function sendOrder() {
        const text = document.getElementById('orderData').value;
        if (!text.includes('#')) {
            alert("è«‹å‹™å¿…åŒ…å« #åº—å®¶åç¨±");
            return;
        }

        try {
            // ä½¿ç”¨ liff.sendMessages åƒä½¿ç”¨è€…è‡ªå·±ç™¼è¨€ä¸€æ¨£
            await liff.sendMessages([{
                type: 'text',
                text: text
            }]);
            alert("å·²å‚³é€ï¼GAS å¾Œå°å°‡è‡ªå‹•è§£æã€‚");
            liff.closeWindow();
        } catch (error) {
            console.error('å‚³é€å¤±æ•—', error);
        }
    }

    // æ¨¡å¼ 3ï¼šè¦æ±‚ GAS ç”¢ç”Ÿåˆ°è²¨é€šçŸ¥
    async function sendNoticeRequest() {
        const store = document.getElementById('storeName').value;
        if (!store) {
            alert("è«‹è¼¸å…¥åº—å®¶åç¨±");
            return;
        }

        try {
            await liff.sendMessages([{
                type: 'text',
                text: `#${store} åˆ°è²¨é€šçŸ¥`
            }]);
            liff.closeWindow();
        } catch (error) {
            console.error('å‚³é€å¤±æ•—', error);
        }
    }
</script>
</body>
</html>
